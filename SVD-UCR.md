### **CUR分解方案（针对HIC矩阵）**

---

#### **一、核心思想**
将矩阵 \( A \in \mathbb{R}^{n \times n} \)（HIC矩阵）近似分解为：  
\[ A \approx C U R \]  
其中：
• \( C \in \mathbb{R}^{n \times c} \): 从 \( A \) 中按重要性选取的列构成的矩阵。
• \( R \in \mathbb{R}^{r \times n} \): 从 \( A \) 中按重要性选取的行构成的矩阵。
• \( U \in \mathbb{R}^{c \times r} \): 最小化近似误差的连接矩阵。

---

#### **二、算法步骤**

1. **计算重要性分数（Leverage Scores）**  
   1.1 计算截断SVD：  
   \[ A \approx U_k \Sigma_k V_k^T \quad (\text{保留前 } k \text{ 个奇异值}) \]  
   1.2 列重要性分数：  
   \[ p_j^{\text{col}} = \frac{\|V_k(j,:)\|_2^2}{k} \quad \text{（第 } j \text{ 列）} \]  
   1.3 行重要性分数：  
   \[ p_i^{\text{row}} = \frac{\|U_k(i,:)\|_2^2}{k} \quad \text{（第 } i \text{ 行）} \]

2. **行列抽样**  
   2.1 列选择：以概率分布 \( \{p_j^{\text{col}}\} \) 不放回抽取 \( c \) 列，构成 \( C \)。  
   2.2 行选择：以概率分布 \( \{p_i^{\text{row}}\} \) 不放回抽取 \( r \) 行，构成 \( R \)。  
   **注**：若 \( A \) 对称，仅抽样一次，令 \( C = R^T \)。

3. **计算连接矩阵 \( U \)**  
   3.1 定义正则化伪逆：  
   \[ C^\dagger = (C^T C + \lambda I)^{-1} C^T, \quad R^\dagger = R^T (R R^T + \lambda I)^{-1} \]  
   3.2 计算 \( U \)：  
   \[ U = C^\dagger A R^\dagger \]

---

#### **三、针对HIC矩阵的优化**

1. **稀疏性加速**  
   • 采用稀疏SVD（如ARPACK）计算截断奇异向量。

2. **对称性利用**  
   • 若 \( A \) 对称，仅需计算列（或行）重要性分数，抽样后令 \( C = R^T \)。

3. **块结构增强**  
   • 调整重要性分数，融合局部接触频率：  
     \[ p_j^{\text{col}} = \alpha \cdot \frac{\|V_k(j,:)\|_2^2}{k} + (1-\alpha) \cdot \frac{\|A(:,j)\|_1}{\|A\|_1} \]  
     其中 \( \alpha \in [0,1] \) 控制奇异向量与原始密度的权重。

---

#### **四、关键参数与调整**

| 参数        | 说明                                                                 | 建议值/方法                          |
|-------------|----------------------------------------------------------------------|--------------------------------------|
| 截断秩 \( k \) | 保留的奇异值数量                                                   | 选择“肘部点”或生物学先验知识（如TAD数量） |
| 抽样数 \( c, r \) | 列/行抽样数量                                                     | \( c = r = 2k \log k \)              |
| 正则化 \( \lambda \) | 防止伪逆病态                                                     | \( \lambda = 10^{-6} \|A\|_F \)     |
| 混合权重 \( \alpha \) | 平衡奇异向量与局部密度                                           | \( \alpha = 0.7 \)（突出结构特征）   |

---

#### **五、评估指标**

1. **数值误差**  
   \[ \text{相对误差} = \frac{\|A - C U R\|_F}{\|A\|_F} \]  
   • 目标：误差 \( \leq 0.2 \)（可接受范围）。

2. **生物学验证**  
   • 检查 \( C \) 和 \( R \) 中选出的行/列是否对应已知的基因组拓扑关联域（TADs）。
   • 通过聚类或可视化验证分解结果的块对角结构。

---

#### **六、公式总结**

• 近似误差上界：  
  \[ \|A - C U R\|_F \leq (1+\epsilon) \|A - A_k\|_F \quad (\text{理论保证}) \]  
• 正则化伪逆：  
  \[ U = (C^T C + \lambda I)^{-1} C^T A R^T (R R^T + \lambda I)^{-1} \]

---

**说明**：通过调整参数 \( k, c, \lambda, \alpha \)，可在计算效率和生物学可解释性之间权衡，适用于大规模稀疏HIC矩阵的压缩与特征提取。