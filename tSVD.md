以下是针对Hi-C矩阵分解的最终tSVD（截断奇异值分解）方案，经过整理，确保严谨、简洁、结构化且清晰。

---

## tSVD方案：Hi-C矩阵分解

### 1. 算法概述

对于 \( m \times n \) 的Hi-C矩阵 \( A \)，tSVD通过奇异值分解（SVD）并保留前 \( k \) 个主要成分，得到近似矩阵 \( A_k \)：
\[
A_k = U_k \Sigma_k V_k^T
\]
- \( U_k \)：\( m \times k \) 矩阵，\( U \) 的前 \( k \) 列（左奇异向量）。
- \( \Sigma_k \)：\( k \times k \) 对角矩阵，包含前 \( k \) 个奇异值 \( \sigma_1 \geq \sigma_2 \geq \dots \geq \sigma_k \)。
- \( V_k \)：\( n \times k \) 矩阵，\( V \) 的前 \( k \) 列（右奇异向量）。

### 2. 自适应截断方法

为自动选择截断秩 \( k \)，采用奇异值累积贡献率：
\[
k = \min \left\{ m \ \middle|\ \frac{\sum_{i=1}^m \sigma_i}{\sum_{i=1}^r \sigma_i} \geq p \right\}
\]
- \( r = \min(m, n) \)：矩阵 \( A \) 的最大可能秩。
- \( p \)：预设比例阈值，表示保留的信息比例。

### 3. 核心公式

- **SVD分解**：
  \[
  A = U \Sigma V^T
  \]
- **tSVD近似**：
  \[
  A_k = U_k \Sigma_k V_k^T
  \]
- **截断秩 \( k \) 的选择**：
  \[
  \frac{\sum_{i=1}^k \sigma_i}{\sum_{i=1}^r \sigma_i} \geq p
  \]

### 4. 参数设置与调整

- **比例阈值 \( p \)**：
  - **含义**：控制保留的奇异值和占总和的比例。
  - **推荐值**：
    - \( p = 0.9 \)：保留90%信息，适用于一般场景。
    - \( p = 0.95 \)：保留95%信息，精度更高。
  - **调整建议**：
    - 奇异值衰减快时，\( p = 0.9 \) 足够。
    - 需更高精度时，可增至 \( p = 0.99 \)。

- **优化选项（大型矩阵）**：
  - 使用随机SVD近似计算前 \( k \) 个奇异值及向量。
  - 额外参数：随机矩阵列数 \( l = k + p_{\text{oversample}} \)（建议 \( p_{\text{oversample}} = 5 \) 或 \( 10 \)）。

### 5. 方案特点

- **逻辑清晰**：基于SVD分解，保留主要信息构造 \( A_k \)。
- **自适应性**：通过 \( p \) 自动确定 \( k \)，无需手动指定。
- **适用性**：适用于Hi-C矩阵降维与特征提取，支持大规模数据优化。

---

这份方案简洁明了，包含算法核心、公式及参数调整建议，确保在Hi-C矩阵分解中高效且严谨的应用。